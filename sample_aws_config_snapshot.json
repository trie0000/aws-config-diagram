{
  "fileVersion": "1.0",
  "requestId": "sample-001-external-audit",
  "configurationItems": [
    {
      "configurationItemVersion": "1.3",
      "resourceId": "vpc-prod001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:vpc/vpc-prod001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::VPC",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-VPC",
        "Environment": "Production"
      },
      "relationships": [
        {"resourceId": "igw-prod001", "resourceType": "AWS::EC2::InternetGateway", "name": "Is attached to InternetGateway"},
        {"resourceId": "subnet-pub-a", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "subnet-pub-c", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "subnet-priv-app-a", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "subnet-priv-app-c", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "subnet-priv-db-a", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "subnet-priv-db-c", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "pcx-prod-mgmt001", "resourceType": "AWS::EC2::VPCPeeringConnection", "name": "Is associated with VPC Peering"}
      ],
      "configuration": {
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.0.0/16",
        "state": "available",
        "isDefault": false,
        "instanceTenancy": "default",
        "cidrBlockAssociationSet": [
          {"cidrBlock": "10.0.0.0/16", "cidrBlockState": {"state": "associated"}}
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "vpc-mgmt001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:vpc/vpc-mgmt001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::VPC",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Management-VPC",
        "Environment": "Management"
      },
      "relationships": [
        {"resourceId": "subnet-mgmt-priv-a", "resourceType": "AWS::EC2::Subnet", "name": "Contains Subnet"},
        {"resourceId": "pcx-prod-mgmt001", "resourceType": "AWS::EC2::VPCPeeringConnection", "name": "Is associated with VPC Peering"}
      ],
      "configuration": {
        "vpcId": "vpc-mgmt001",
        "cidrBlock": "10.1.0.0/16",
        "state": "available",
        "isDefault": false,
        "instanceTenancy": "default",
        "cidrBlockAssociationSet": [
          {"cidrBlock": "10.1.0.0/16", "cidrBlockState": {"state": "associated"}}
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "igw-prod001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:internet-gateway/igw-prod001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::InternetGateway",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-IGW"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is attached to VPC"}
      ],
      "configuration": {
        "internetGatewayId": "igw-prod001",
        "attachments": [
          {"vpcId": "vpc-prod001", "state": "available"}
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-pub-a",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-pub-a",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Production-Public-Subnet-AZ-a",
        "Tier": "Public"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-pub-a",
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.1.0/24",
        "availabilityZone": "ap-northeast-1a",
        "mapPublicIpOnLaunch": true,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-pub-c",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-pub-c",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1c",
      "tags": {
        "Name": "Production-Public-Subnet-AZ-c",
        "Tier": "Public"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-pub-c",
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.4.0/24",
        "availabilityZone": "ap-northeast-1c",
        "mapPublicIpOnLaunch": true,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-priv-app-a",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-priv-app-a",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Production-Private-App-Subnet-AZ-a",
        "Tier": "Private"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-priv-app-a",
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.2.0/24",
        "availabilityZone": "ap-northeast-1a",
        "mapPublicIpOnLaunch": false,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-priv-app-c",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-priv-app-c",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1c",
      "tags": {
        "Name": "Production-Private-App-Subnet-AZ-c",
        "Tier": "Private"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-priv-app-c",
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.5.0/24",
        "availabilityZone": "ap-northeast-1c",
        "mapPublicIpOnLaunch": false,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-priv-db-a",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-priv-db-a",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Production-Private-DB-Subnet-AZ-a",
        "Tier": "Isolated"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-priv-db-a",
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.3.0/24",
        "availabilityZone": "ap-northeast-1a",
        "mapPublicIpOnLaunch": false,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-priv-db-c",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-priv-db-c",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1c",
      "tags": {
        "Name": "Production-Private-DB-Subnet-AZ-c",
        "Tier": "Isolated"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-priv-db-c",
        "vpcId": "vpc-prod001",
        "cidrBlock": "10.0.6.0/24",
        "availabilityZone": "ap-northeast-1c",
        "mapPublicIpOnLaunch": false,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "subnet-mgmt-priv-a",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:subnet/subnet-mgmt-priv-a",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Subnet",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Management-Private-Subnet-AZ-a",
        "Tier": "Private"
      },
      "relationships": [
        {"resourceId": "vpc-mgmt001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "subnetId": "subnet-mgmt-priv-a",
        "vpcId": "vpc-mgmt001",
        "cidrBlock": "10.1.1.0/24",
        "availabilityZone": "ap-northeast-1a",
        "mapPublicIpOnLaunch": false,
        "state": "available"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "nat-prod001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:natgateway/nat-prod001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::NatGateway",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-NAT-Gateway"
      },
      "relationships": [
        {"resourceId": "subnet-pub-a", "resourceType": "AWS::EC2::Subnet", "name": "Is contained in Subnet"},
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "natGatewayId": "nat-prod001",
        "subnetId": "subnet-pub-a",
        "vpcId": "vpc-prod001",
        "state": "available",
        "connectivityType": "public",
        "natGatewayAddresses": [
          {
            "allocationId": "eipalloc-prod001",
            "networkInterfaceId": "eni-nat001",
            "privateIp": "10.0.1.50",
            "publicIp": "52.194.100.10"
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "arn:aws:elasticloadbalancing:ap-northeast-1:123456789012:loadbalancer/app/prod-alb/1234567890abcdef",
      "arn": "arn:aws:elasticloadbalancing:ap-northeast-1:123456789012:loadbalancer/app/prod-alb/1234567890abcdef",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::ElasticLoadBalancingV2::LoadBalancer",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-ALB"
      },
      "relationships": [
        {"resourceId": "subnet-pub-a", "resourceType": "AWS::EC2::Subnet", "name": "Is in Subnet"},
        {"resourceId": "subnet-pub-c", "resourceType": "AWS::EC2::Subnet", "name": "Is in Subnet"},
        {"resourceId": "sg-alb001", "resourceType": "AWS::EC2::SecurityGroup", "name": "Is associated with SecurityGroup"},
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is in VPC"}
      ],
      "configuration": {
        "loadBalancerName": "prod-alb",
        "dNSName": "prod-alb-1234567890.ap-northeast-1.elb.amazonaws.com",
        "type": "application",
        "scheme": "internet-facing",
        "state": {"code": "active"},
        "vpcId": "vpc-prod001",
        "availabilityZones": [
          {"zoneName": "ap-northeast-1a", "subnetId": "subnet-pub-a"},
          {"zoneName": "ap-northeast-1c", "subnetId": "subnet-pub-c"}
        ],
        "securityGroups": ["sg-alb001"],
        "ipAddressType": "ipv4"
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "i-web001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:instance/i-web001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Instance",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Web-Server-1",
        "Role": "WebServer"
      },
      "relationships": [
        {"resourceId": "subnet-priv-app-a", "resourceType": "AWS::EC2::Subnet", "name": "Is contained in Subnet"},
        {"resourceId": "sg-web001", "resourceType": "AWS::EC2::SecurityGroup", "name": "Is associated with SecurityGroup"},
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "instanceId": "i-web001",
        "imageId": "ami-0abcdef1234567890",
        "instanceType": "t3.medium",
        "state": {"code": 16, "name": "running"},
        "subnetId": "subnet-priv-app-a",
        "vpcId": "vpc-prod001",
        "privateIpAddress": "10.0.2.10",
        "publicIpAddress": null,
        "securityGroups": [
          {"groupName": "Web-Server-SG", "groupId": "sg-web001"}
        ],
        "networkInterfaces": [
          {
            "networkInterfaceId": "eni-web001",
            "subnetId": "subnet-priv-app-a",
            "vpcId": "vpc-prod001",
            "privateIpAddress": "10.0.2.10",
            "groups": [{"groupName": "Web-Server-SG", "groupId": "sg-web001"}]
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "i-web002",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:instance/i-web002",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Instance",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1c",
      "tags": {
        "Name": "Web-Server-2",
        "Role": "WebServer"
      },
      "relationships": [
        {"resourceId": "subnet-priv-app-c", "resourceType": "AWS::EC2::Subnet", "name": "Is contained in Subnet"},
        {"resourceId": "sg-web001", "resourceType": "AWS::EC2::SecurityGroup", "name": "Is associated with SecurityGroup"},
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "instanceId": "i-web002",
        "imageId": "ami-0abcdef1234567890",
        "instanceType": "t3.medium",
        "state": {"code": 16, "name": "running"},
        "subnetId": "subnet-priv-app-c",
        "vpcId": "vpc-prod001",
        "privateIpAddress": "10.0.5.10",
        "publicIpAddress": null,
        "securityGroups": [
          {"groupName": "Web-Server-SG", "groupId": "sg-web001"}
        ],
        "networkInterfaces": [
          {
            "networkInterfaceId": "eni-web002",
            "subnetId": "subnet-priv-app-c",
            "vpcId": "vpc-prod001",
            "privateIpAddress": "10.0.5.10",
            "groups": [{"groupName": "Web-Server-SG", "groupId": "sg-web001"}]
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "i-bastion001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:instance/i-bastion001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::Instance",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Bastion-Host",
        "Role": "Bastion"
      },
      "relationships": [
        {"resourceId": "subnet-mgmt-priv-a", "resourceType": "AWS::EC2::Subnet", "name": "Is contained in Subnet"},
        {"resourceId": "sg-bastion001", "resourceType": "AWS::EC2::SecurityGroup", "name": "Is associated with SecurityGroup"},
        {"resourceId": "vpc-mgmt001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "instanceId": "i-bastion001",
        "imageId": "ami-0abcdef1234567890",
        "instanceType": "t3.micro",
        "state": {"code": 16, "name": "running"},
        "subnetId": "subnet-mgmt-priv-a",
        "vpcId": "vpc-mgmt001",
        "privateIpAddress": "10.1.1.10",
        "publicIpAddress": null,
        "securityGroups": [
          {"groupName": "Bastion-SG", "groupId": "sg-bastion001"}
        ],
        "networkInterfaces": [
          {
            "networkInterfaceId": "eni-bastion001",
            "subnetId": "subnet-mgmt-priv-a",
            "vpcId": "vpc-mgmt001",
            "privateIpAddress": "10.1.1.10",
            "groups": [{"groupName": "Bastion-SG", "groupId": "sg-bastion001"}]
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "db-prod-mysql001",
      "arn": "arn:aws:rds:ap-northeast-1:123456789012:db:prod-mysql001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::RDS::DBInstance",
      "awsRegion": "ap-northeast-1",
      "availibilityZone": "ap-northeast-1a",
      "tags": {
        "Name": "Production-MySQL",
        "Environment": "Production"
      },
      "relationships": [
        {"resourceId": "sg-rds001", "resourceType": "AWS::EC2::SecurityGroup", "name": "Is associated with SecurityGroup"},
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "dBInstanceIdentifier": "prod-mysql001",
        "dBInstanceClass": "db.r5.large",
        "engine": "mysql",
        "engineVersion": "8.0.35",
        "dBInstanceStatus": "available",
        "endpoint": {
          "address": "prod-mysql001.abcdef123456.ap-northeast-1.rds.amazonaws.com",
          "port": 3306
        },
        "multiAZ": true,
        "availabilityZone": "ap-northeast-1a",
        "dBSubnetGroup": {
          "dBSubnetGroupName": "prod-db-subnet-group",
          "vpcId": "vpc-prod001",
          "subnets": [
            {"subnetIdentifier": "subnet-priv-db-a", "subnetAvailabilityZone": {"name": "ap-northeast-1a"}},
            {"subnetIdentifier": "subnet-priv-db-c", "subnetAvailabilityZone": {"name": "ap-northeast-1c"}}
          ]
        },
        "vpcSecurityGroups": [
          {"vpcSecurityGroupId": "sg-rds001", "status": "active"}
        ],
        "publiclyAccessible": false,
        "storageEncrypted": true
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "sg-alb001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:security-group/sg-alb001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::SecurityGroup",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "ALB-SecurityGroup"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "groupId": "sg-alb001",
        "groupName": "ALB-SecurityGroup",
        "description": "Security group for Production ALB",
        "vpcId": "vpc-prod001",
        "ipPermissions": [
          {
            "ipProtocol": "tcp",
            "fromPort": 443,
            "toPort": 443,
            "ipRanges": [{"cidrIp": "0.0.0.0/0", "description": "HTTPS from Internet"}],
            "ipv6Ranges": [{"cidrIpv6": "::/0", "description": "HTTPS from Internet IPv6"}],
            "userIdGroupPairs": []
          },
          {
            "ipProtocol": "tcp",
            "fromPort": 80,
            "toPort": 80,
            "ipRanges": [{"cidrIp": "0.0.0.0/0", "description": "HTTP from Internet (redirect to HTTPS)"}],
            "ipv6Ranges": [],
            "userIdGroupPairs": []
          }
        ],
        "ipPermissionsEgress": [
          {
            "ipProtocol": "tcp",
            "fromPort": 8080,
            "toPort": 8080,
            "ipRanges": [],
            "userIdGroupPairs": [
              {"groupId": "sg-web001", "description": "To Web Servers"}
            ]
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "sg-web001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:security-group/sg-web001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::SecurityGroup",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Web-Server-SecurityGroup"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "groupId": "sg-web001",
        "groupName": "Web-Server-SG",
        "description": "Security group for Web Servers",
        "vpcId": "vpc-prod001",
        "ipPermissions": [
          {
            "ipProtocol": "tcp",
            "fromPort": 8080,
            "toPort": 8080,
            "ipRanges": [],
            "userIdGroupPairs": [
              {"groupId": "sg-alb001", "description": "From ALB only"}
            ]
          },
          {
            "ipProtocol": "tcp",
            "fromPort": 22,
            "toPort": 22,
            "ipRanges": [],
            "userIdGroupPairs": [
              {"groupId": "sg-bastion001", "description": "SSH from Bastion only"}
            ]
          }
        ],
        "ipPermissionsEgress": [
          {
            "ipProtocol": "tcp",
            "fromPort": 3306,
            "toPort": 3306,
            "ipRanges": [],
            "userIdGroupPairs": [
              {"groupId": "sg-rds001", "description": "To RDS MySQL"}
            ]
          },
          {
            "ipProtocol": "tcp",
            "fromPort": 443,
            "toPort": 443,
            "ipRanges": [{"cidrIp": "0.0.0.0/0", "description": "HTTPS outbound via NAT GW"}],
            "userIdGroupPairs": []
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "sg-rds001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:security-group/sg-rds001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::SecurityGroup",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "RDS-SecurityGroup"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "groupId": "sg-rds001",
        "groupName": "RDS-SecurityGroup",
        "description": "Security group for RDS MySQL",
        "vpcId": "vpc-prod001",
        "ipPermissions": [
          {
            "ipProtocol": "tcp",
            "fromPort": 3306,
            "toPort": 3306,
            "ipRanges": [],
            "userIdGroupPairs": [
              {"groupId": "sg-web001", "description": "From Web Servers only"}
            ]
          }
        ],
        "ipPermissionsEgress": []
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "sg-bastion001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:security-group/sg-bastion001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::SecurityGroup",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Bastion-SecurityGroup"
      },
      "relationships": [
        {"resourceId": "vpc-mgmt001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"}
      ],
      "configuration": {
        "groupId": "sg-bastion001",
        "groupName": "Bastion-SG",
        "description": "Security group for Bastion Host",
        "vpcId": "vpc-mgmt001",
        "ipPermissions": [
          {
            "ipProtocol": "tcp",
            "fromPort": 22,
            "toPort": 22,
            "ipRanges": [{"cidrIp": "203.0.113.0/24", "description": "SSH from Corporate Office only"}],
            "userIdGroupPairs": []
          }
        ],
        "ipPermissionsEgress": [
          {
            "ipProtocol": "tcp",
            "fromPort": 22,
            "toPort": 22,
            "ipRanges": [{"cidrIp": "10.0.0.0/16", "description": "SSH to Production VPC via Peering"}],
            "userIdGroupPairs": []
          }
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "pcx-prod-mgmt001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:vpc-peering-connection/pcx-prod-mgmt001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::VPCPeeringConnection",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-Management-Peering"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is associated with Accepter VPC"},
        {"resourceId": "vpc-mgmt001", "resourceType": "AWS::EC2::VPC", "name": "Is associated with Requester VPC"}
      ],
      "configuration": {
        "vpcPeeringConnectionId": "pcx-prod-mgmt001",
        "status": {"code": "active", "message": "Active"},
        "accepterVpcInfo": {
          "ownerId": "123456789012",
          "vpcId": "vpc-prod001",
          "cidrBlock": "10.0.0.0/16",
          "region": "ap-northeast-1"
        },
        "requesterVpcInfo": {
          "ownerId": "123456789012",
          "vpcId": "vpc-mgmt001",
          "cidrBlock": "10.1.0.0/16",
          "region": "ap-northeast-1"
        }
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "rtb-pub-prod001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:route-table/rtb-pub-prod001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::RouteTable",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-Public-RouteTable"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"},
        {"resourceId": "subnet-pub-a", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"},
        {"resourceId": "subnet-pub-c", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"}
      ],
      "configuration": {
        "routeTableId": "rtb-pub-prod001",
        "vpcId": "vpc-prod001",
        "routes": [
          {"destinationCidrBlock": "10.0.0.0/16", "gatewayId": "local", "state": "active", "origin": "CreateRouteTable"},
          {"destinationCidrBlock": "0.0.0.0/0", "gatewayId": "igw-prod001", "state": "active", "origin": "CreateRoute"},
          {"destinationCidrBlock": "10.1.0.0/16", "vpcPeeringConnectionId": "pcx-prod-mgmt001", "state": "active", "origin": "CreateRoute"}
        ],
        "associations": [
          {"routeTableAssociationId": "rtbassoc-pub-a", "subnetId": "subnet-pub-a", "main": false},
          {"routeTableAssociationId": "rtbassoc-pub-c", "subnetId": "subnet-pub-c", "main": false}
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "rtb-priv-app-prod001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:route-table/rtb-priv-app-prod001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::RouteTable",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-Private-App-RouteTable"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"},
        {"resourceId": "subnet-priv-app-a", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"},
        {"resourceId": "subnet-priv-app-c", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"}
      ],
      "configuration": {
        "routeTableId": "rtb-priv-app-prod001",
        "vpcId": "vpc-prod001",
        "routes": [
          {"destinationCidrBlock": "10.0.0.0/16", "gatewayId": "local", "state": "active", "origin": "CreateRouteTable"},
          {"destinationCidrBlock": "0.0.0.0/0", "natGatewayId": "nat-prod001", "state": "active", "origin": "CreateRoute"},
          {"destinationCidrBlock": "10.1.0.0/16", "vpcPeeringConnectionId": "pcx-prod-mgmt001", "state": "active", "origin": "CreateRoute"}
        ],
        "associations": [
          {"routeTableAssociationId": "rtbassoc-priv-app-a", "subnetId": "subnet-priv-app-a", "main": false},
          {"routeTableAssociationId": "rtbassoc-priv-app-c", "subnetId": "subnet-priv-app-c", "main": false}
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "rtb-priv-db-prod001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:route-table/rtb-priv-db-prod001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::RouteTable",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Production-Private-DB-RouteTable"
      },
      "relationships": [
        {"resourceId": "vpc-prod001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"},
        {"resourceId": "subnet-priv-db-a", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"},
        {"resourceId": "subnet-priv-db-c", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"}
      ],
      "configuration": {
        "routeTableId": "rtb-priv-db-prod001",
        "vpcId": "vpc-prod001",
        "routes": [
          {"destinationCidrBlock": "10.0.0.0/16", "gatewayId": "local", "state": "active", "origin": "CreateRouteTable"}
        ],
        "associations": [
          {"routeTableAssociationId": "rtbassoc-priv-db-a", "subnetId": "subnet-priv-db-a", "main": false},
          {"routeTableAssociationId": "rtbassoc-priv-db-c", "subnetId": "subnet-priv-db-c", "main": false}
        ]
      }
    },
    {
      "configurationItemVersion": "1.3",
      "resourceId": "rtb-mgmt001",
      "arn": "arn:aws:ec2:ap-northeast-1:123456789012:route-table/rtb-mgmt001",
      "accountId": "123456789012",
      "configurationItemCaptureTime": "2025-01-15T10:00:00.000Z",
      "configurationItemStatus": "OK",
      "resourceType": "AWS::EC2::RouteTable",
      "awsRegion": "ap-northeast-1",
      "tags": {
        "Name": "Management-RouteTable"
      },
      "relationships": [
        {"resourceId": "vpc-mgmt001", "resourceType": "AWS::EC2::VPC", "name": "Is contained in VPC"},
        {"resourceId": "subnet-mgmt-priv-a", "resourceType": "AWS::EC2::Subnet", "name": "Is associated with Subnet"}
      ],
      "configuration": {
        "routeTableId": "rtb-mgmt001",
        "vpcId": "vpc-mgmt001",
        "routes": [
          {"destinationCidrBlock": "10.1.0.0/16", "gatewayId": "local", "state": "active", "origin": "CreateRouteTable"},
          {"destinationCidrBlock": "10.0.0.0/16", "vpcPeeringConnectionId": "pcx-prod-mgmt001", "state": "active", "origin": "CreateRoute"}
        ],
        "associations": [
          {"routeTableAssociationId": "rtbassoc-mgmt-a", "subnetId": "subnet-mgmt-priv-a", "main": false}
        ]
      }
    }
  ]
}
