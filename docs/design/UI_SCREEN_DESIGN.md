# UI 画面設計書

> 作成日: 2026-02-13
> 目的: 各画面の構成・機能配置・画面遷移を定義し、ChatGPT での画面イメージ生成のベースとする

---

## 1. 機能一覧（MVP → 拡張の順）

### MVP (Phase 1.5 Must)

| # | 機能 | 概要 |
|---|------|------|
| F01 | Config JSON アップロード | JSONファイルをドラッグ&ドロップまたはファイル選択でアップロード |
| F02 | 自動レイアウト生成 | パース → レイアウト計算 → SVG Canvas に構成図表示 |
| F03 | ズーム/パン | マウスホイールでズーム、ドラッグで画面移動 |
| F04 | リソース選択 | クリックでリソースを選択、詳細パネルに情報表示 |
| F05 | ドラッグ&ドロップ移動 | リソースの位置を手動調整 |
| F06 | 位置ロック | 個別リソースの位置をロック（誤移動防止） |
| F07 | Undo/Redo | Ctrl+Z / Ctrl+Shift+Z で操作取消・やり直し |
| F08 | Excel エクスポート | 現在の構成図を .xlsx でダウンロード |
| F09 | PowerPoint エクスポート | 現在の構成図を .pptx でダウンロード |
| F10 | リソース詳細パネル | 選択リソースのAWS情報（ID、タグ、SG等）を表示 |
| F11 | 親子階層表示 | VPC > AZ > Subnet > Resource の4階層を入れ子矩形で表現 |
| F12 | グリッド＆スナップ | グリッド表示、スナップによる整列支援 |

### Phase 2 (Should)

| # | 機能 | 概要 |
|---|------|------|
| F13 | 外部システム追加 | オンプレ・SaaS等の手動ノード追加（テンプレート付き） |
| F14 | 接続線（エッジ）追加 | リソース間の接続線を手動で追加・編集 |
| F15 | コメント/アノテーション | ノード・エッジにコメント追加（スレッド・解決済みフラグ） |
| F16 | レイヤー管理 | 5レイヤーの表示切替・ロック（インフラ/セキュリティ/外部/コンプライアンス/注釈） |
| F17 | JSON 再インポート＆マージ | 新しいJSONをインポート時に手動変更を保護するマージUI |
| F18 | バージョンスナップショット | 図の時点保存・復元 |
| F19 | エクスポートプリセット | レイヤー選択・コメント有無等の出力設定を保存 |
| F20 | リスク可視化 | SG開放ポートのリスクレベルを色分け表示 |

### Phase 3 (Nice to have)

| # | 機能 | 概要 |
|---|------|------|
| F21 | 差分比較（Diff） | 2つのConfig JSONの変更点を色分けハイライト |
| F22 | 折りたたみ/展開 | VPC/Subnetの子要素を折りたたみ |
| F23 | 任意グループ化 | 業務単位でリソースをグルーピング |
| F24 | カスタムプロパティ | ユーザー定義のkey-valueをリソースに追加 |
| F25 | テキストボックス/自由描画 | フリーテキスト・図形の追加 |
| F26 | リンク/URL埋め込み | リソースにAWSコンソールURL等を紐付け |

---

## 2. 画面一覧

| 画面ID | 画面名 | 種別 | 主な機能 |
|--------|-------|------|---------|
| S01 | スタート画面 | ページ | JSON アップロード (F01) |
| S02 | メインエディタ | ページ | Canvas + ツールバー + パネル (F02-F12) |
| S03 | リソース詳細パネル | サイドパネル | 選択リソースの情報表示・編集 (F10) |
| S04 | エクスポートダイアログ | モーダル | Excel/PPTX ダウンロード設定 (F08, F09) |
| S05 | 外部システム追加ダイアログ | モーダル | ノード追加フォーム (F13) |
| S06 | 接続線追加モード | オーバーレイ | エッジの始点・終点選択 (F14) |
| S07 | コメントパネル | サイドパネル | コメント一覧・スレッド表示 (F15) |
| S08 | レイヤーパネル | サイドパネル | レイヤーの表示/非表示/ロック切替 (F16) |
| S09 | 再インポートマージダイアログ | モーダル | 変更差分表示・マージ方針選択 (F17) |
| S10 | バージョン履歴パネル | サイドパネル | スナップショット一覧・復元 (F18) |
| S11 | エクスポートプリセット設定 | モーダル | 出力設定の保存・管理 (F19) |
| S12 | Diff比較画面 | ページ | 2つのJSONの差分表示 (F21) |
| S13 | 設定ダイアログ | モーダル | グリッド設定・Canvas設定・表示設定 |

---

## 3. 各画面の詳細設計

### S01: スタート画面

**目的**: Config JSON のアップロードとツールの概要表示

```
┌─────────────────────────────────────────────────────────┐
│  [ロゴ] AWS Config Diagram Generator                    │
│                                                         │
│  ┌─────────────────────────────────────────────────┐    │
│  │                                                 │    │
│  │     📁  Config JSON をドロップ                    │    │
│  │         またはクリックしてファイル選択             │    │
│  │                                                 │    │
│  │     対応形式: AWS Config Snapshot JSON            │    │
│  │                                                 │    │
│  └─────────────────────────────────────────────────┘    │
│                                                         │
│  ── または ──────────────────────────────────────       │
│                                                         │
│  [サンプルを試す]  [最近のファイル ▼]                     │
│                                                         │
│  ─────────────────────────────────────────────────      │
│  💡 使い方:                                              │
│  1. AWS Config Snapshot JSON を取得                      │
│  2. ここにアップロード                                    │
│  3. 構成図が自動生成されます                               │
│  4. ドラッグ&ドロップで配置を調整                          │
│  5. Excel/PowerPoint でエクスポート                       │
└─────────────────────────────────────────────────────────┘
```

**構成要素**:
- ドラッグ&ドロップエリア（中央、大きめ）
- ファイル選択ボタン（ドロップエリア内）
- サンプルJSONで試すボタン
- 最近開いたファイルのドロップダウン（IndexedDB から）
- 簡易説明テキスト

**状態遷移**:
- ファイルドロップ/選択 → ローディング表示 → S02 (メインエディタ) へ遷移
- サンプルボタンクリック → 組み込みサンプルJSON読み込み → S02 へ遷移

---

### S02: メインエディタ

**目的**: 構成図の表示・編集のメイン画面。全操作の起点。

```
┌──────────────────────────────────────────────────────────────┐
│ [ツールバー]                                                  │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ 📁▾  💾  ↩️ ↪️ │ 🖱️ ✋ 🔗 💬 📝 │ 🔍- 100% 🔍+ ⬜ │ ⚙️ │ │
│ │ File Undo/Redo  Tools         Zoom        Settings │ │
│ └──────────────────────────────────────────────────────────┘ │
│ ┌────────────────────────────────────┬───────────────────┐   │
│ │                                    │ [右パネル]         │   │
│ │                                    │                   │   │
│ │    ┌─── VPC (10.0.0.0/16) ──────┐ │ リソース詳細      │   │
│ │    │                             │ │ ──────────        │   │
│ │    │  ┌─ AZ: ap-northeast-1a ─┐  │ │ 📦 i-0abc123     │   │
│ │    │  │                       │  │ │ Type: t3.medium   │   │
│ │    │  │  ┌─ Public Subnet ─┐  │  │ │ State: running   │   │
│ │    │  │  │  [EC2] [NAT]    │  │  │ │ AZ: 1a           │   │
│ │    │  │  └─────────────────┘  │  │ │ SG: sg-xxx       │   │
│ │    │  │                       │  │ │                   │   │
│ │    │  │  ┌─ Private Subnet ┐  │  │ │ Tags:            │   │
│ │    │  │  │  [EC2] [RDS]    │  │  │ │  Name: web-01    │   │
│ │    │  │  └─────────────────┘  │  │ │  Env: prod       │   │
│ │    │  │                       │  │ │                   │   │
│ │    │  └───────────────────────┘  │ │ [🔒 Lock] [📋]   │   │
│ │    │                             │ │                   │   │
│ │    └─────────────────────────────┘ │                   │   │
│ │                                    │                   │   │
│ │  [IGW]◄─────────────►[CloudFront]  │                   │   │
│ │                                    │                   │   │
│ │ ┌ ミニマップ ┐                      │                   │   │
│ │ │ [■]       │                      │                   │   │
│ │ └───────────┘                      │                   │   │
│ └────────────────────────────────────┴───────────────────┘   │
│ [ステータスバー]                                              │
│ ┌──────────────────────────────────────────────────────────┐ │
│ │ Nodes: 47  │ Edges: 23  │ Zoom: 100%  │ Grid: ON  │ ✓  │ │
│ └──────────────────────────────────────────────────────────┘ │
└──────────────────────────────────────────────────────────────┘
```

**レイアウト構成** (4ゾーン):

| ゾーン | 位置 | 内容 |
|--------|------|------|
| ツールバー | 上部固定 | ファイル操作、編集ツール、ズーム、設定 |
| SVG Canvas | 中央（可変） | 構成図表示・編集エリア |
| 右パネル | 右側（折りたたみ可） | リソース詳細、コメント、レイヤー等のタブ切替 |
| ステータスバー | 下部固定 | ノード/エッジ数、ズーム率、グリッド状態 |

#### ツールバーの構成

```
┌─────────────────────────────────────────────────────────────────┐
│ [File ▾]  [Save]  │  [⟲][⟳]  │  [Select][Pan][Edge][Comment]  │
│                    │  Undo Redo│  [AddNode]                     │
│─────────────────── │──────────│──────────────────────────────── │
│ ファイル操作        │ 履歴     │ ツール切替                      │
│                    │          │                                 │
│──────────────────────────────────────────────────────────────── │
│ [−] [100%] [+] [Fit] │ [Grid ☑] [Snap ☑] │ [Export ▾] [⚙️]   │
│ ズームコントロール     │ グリッド設定        │ エクスポート / 設定 │
└─────────────────────────────────────────────────────────────────┘
```

| ボタングループ | ボタン | 機能 | ショートカット |
|---------------|--------|------|-------------|
| File | File ▾ | ファイルメニュー（新規/開く/保存/インポート） | - |
| | Save | 現在の状態を保存（IndexedDB） | Ctrl+S |
| History | Undo | 操作取消 | Ctrl+Z |
| | Redo | やり直し | Ctrl+Shift+Z |
| Tools | Select | 選択モード（デフォルト） | V |
| | Pan | 画面移動モード | H |
| | Edge | 接続線追加モード (Phase 2) | E |
| | Comment | コメント追加モード (Phase 2) | C |
| | AddNode | 外部システム追加 (Phase 2) | N |
| Zoom | − / + | ズームイン・アウト | Ctrl+- / Ctrl+= |
| | 100% | 現在のズーム率表示 | - |
| | Fit | 全体が見えるようにフィット | Ctrl+0 |
| Grid | Grid | グリッド表示切替 | Ctrl+G |
| | Snap | スナップ切替 | Ctrl+Shift+G |
| Export | Export ▾ | エクスポートメニュー | - |
| Settings | ⚙️ | 設定ダイアログ (S13) | Ctrl+, |

#### 右パネルのタブ構成

| タブ | 表示内容 | フェーズ |
|------|---------|---------|
| 📦 詳細 | 選択リソースの情報 | MVP |
| 💬 コメント | コメント一覧・スレッド | Phase 2 |
| 📑 レイヤー | レイヤー表示/非表示/ロック | Phase 2 |
| 📜 履歴 | バージョンスナップショット | Phase 2 |

---

### S03: リソース詳細パネル（右パネル > 詳細タブ）

**目的**: 選択リソースの全情報を表示・一部編集可能

```
┌─ リソース詳細 ──────────────────┐
│                                 │
│ 📦 本番Web Server               │
│ ──────────────────────────      │
│                                 │
│ ■ 基本情報                       │
│ ┌─────────────────────────────┐ │
│ │ Type:     EC2 Instance      │ │
│ │ ID:       i-0abc123def456   │ │
│ │ Name:     web-server-01     │ │
│ │ AZ:       ap-northeast-1a   │ │
│ │ State:    ● running         │ │
│ │ Instance: t3.medium         │ │
│ │ Source:   🟢 AWS Config     │ │
│ └─────────────────────────────┘ │
│                                 │
│ ■ ネットワーク                    │
│ ┌─────────────────────────────┐ │
│ │ VPC:      vpc-0abc (本番)    │ │
│ │ Subnet:   subnet-123        │ │
│ │ Private:  10.0.1.50         │ │
│ │ Public:   54.xxx.xxx.xxx    │ │
│ └─────────────────────────────┘ │
│                                 │
│ ■ セキュリティグループ             │
│ ┌─────────────────────────────┐ │
│ │ sg-0abc123 (web-sg)         │ │
│ │  Inbound:                   │ │
│ │   ⚠️ 0.0.0.0/0 → 443/tcp   │ │
│ │   ✅ 10.0.0.0/16 → 22/tcp  │ │
│ │  Outbound:                  │ │
│ │   ✅ 0.0.0.0/0 → ALL       │ │
│ └─────────────────────────────┘ │
│                                 │
│ ■ タグ                           │
│ ┌─────────────────────────────┐ │
│ │ Environment: Production     │ │
│ │ Team:        Platform       │ │
│ │ CostCenter:  CC-001         │ │
│ └─────────────────────────────┘ │
│                                 │
│ ■ 表示設定                       │
│ ┌─────────────────────────────┐ │
│ │ ラベル:  [本番Web Server  ]  │ │
│ │ ロック:  [☐ 位置をロック]     │ │
│ │ 表示:   [☑ 表示する]         │ │
│ └─────────────────────────────┘ │
│                                 │
│ [📋 コピー]  [🗑️ 削除]          │
│ (※ AWS Config由来は削除不可)     │
└─────────────────────────────────┘
```

**セクション**:
1. **基本情報**: リソースタイプ、ID、名前、AZ、状態、Source種別
2. **ネットワーク**: VPC、Subnet、IPアドレス
3. **セキュリティグループ**: インバウンド/アウトバウンドルール（リスクアイコン付き）
4. **タグ**: AWS タグ一覧
5. **表示設定**: ラベル編集、位置ロック、表示/非表示

**操作**:
- ラベル変更 → `isUserModified = true` にセット
- ロック切替 → `isLocked` トグル
- 削除ボタン → `source: "aws-config"` の場合は非表示化（完全削除はしない）
- `source: "user-manual"` の場合は削除確認ダイアログ後に削除

---

### S04: エクスポートダイアログ

**目的**: Excel/PPTX ダウンロードの設定・実行

```
┌─── エクスポート ──────────────────────────────┐
│                                               │
│  出力形式                                      │
│  ┌──────────┐ ┌──────────┐                    │
│  │   📊     │ │   📑     │                    │
│  │  Excel   │ │  PPTX    │                    │
│  │ (.xlsx)  │ │ (.pptx)  │                    │
│  └──────────┘ └──────────┘                    │
│                                               │
│  オプション                                    │
│  ┌───────────────────────────────────────┐    │
│  │ ☑ 現在の配置を反映                      │    │
│  │ ☐ コメントを含める       (Phase 2)      │    │
│  │ ☐ コンプライアンス色付け  (Phase 2)      │    │
│  └───────────────────────────────────────┘    │
│                                               │
│  プリセット (Phase 2)                          │
│  ┌───────────────────────────────────────┐    │
│  │ [監査報告書用 ▾]  [保存] [管理...]      │    │
│  └───────────────────────────────────────┘    │
│                                               │
│  ──────────────────────────────────────       │
│                                               │
│              [キャンセル]  [ダウンロード]       │
└───────────────────────────────────────────────┘
```

---

### S05: 外部システム追加ダイアログ (Phase 2)

**目的**: AWS外のシステム（オンプレ、SaaS等）をノードとして追加

```
┌─── 外部システムの追加 ─────────────────────────┐
│                                               │
│  テンプレート選択                               │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐   │
│  │ 🖥️  │ │ ☁️  │ │ 🌐  │ │ 📱  │ │ ⚡  │   │
│  │オンプ│ │他Cloud│ │SaaS │ │モバ │ │カスタ│   │
│  │レ   │ │     │ │     │ │イル │ │ム   │   │
│  └─────┘ └─────┘ └─────┘ └─────┘ └─────┘   │
│                                               │
│  基本情報                                      │
│  ┌───────────────────────────────────────┐    │
│  │ ラベル:    [                        ]  │    │
│  │ 説明:     [                        ]  │    │
│  │ アイコン:  [オンプレサーバ ▾]           │    │
│  └───────────────────────────────────────┘    │
│                                               │
│  接続情報（任意）                               │
│  ┌───────────────────────────────────────┐    │
│  │ IP/ホスト:   [                     ]   │    │
│  │ プロトコル:  [HTTPS ▾]                 │    │
│  │ ポート:     [443               ]      │    │
│  │ 担当者:     [                     ]   │    │
│  └───────────────────────────────────────┘    │
│                                               │
│              [キャンセル]  [追加]               │
└───────────────────────────────────────────────┘
```

---

### S07: コメントパネル (Phase 2, 右パネル > コメントタブ)

```
┌─ コメント ──────────────────────┐
│                                 │
│ [🔽 フィルター] [+ 新規コメント]  │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ 📦 本番Web Server に対して    │ │
│ │ ───────────────────          │ │
│ │ 🟡 trie  2/13 14:00         │ │
│ │ 次回メンテ時にインスタンス     │ │
│ │ タイプをm5.xlargeに変更予定   │ │
│ │                              │ │
│ │   └─ tanaka  2/13 15:30     │ │
│ │      承認しました。3月1日に   │ │
│ │      実施予定で進めます       │ │
│ │                              │ │
│ │ [✅ 解決済み] [返信]          │ │
│ └─────────────────────────────┘ │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ 🔗 ALB → EC2 接続線に対して  │ │
│ │ ───────────────────          │ │
│ │ ⚠️ trie  2/13 16:00         │ │
│ │ SG設定を確認。0.0.0.0/0の   │ │
│ │ SSH開放は次回対応予定         │ │
│ │                              │ │
│ │ [未解決] [返信]              │ │
│ └─────────────────────────────┘ │
│                                 │
└─────────────────────────────────┘
```

---

### S08: レイヤーパネル (Phase 2, 右パネル > レイヤータブ)

```
┌─ レイヤー ──────────────────────┐
│                                 │
│ ┌─────────────────────────────┐ │
│ │ 👁️ 🔓  🟢 インフラ構成       │ │
│ │        VPC/AZ/Subnet/リソース │ │
│ ├─────────────────────────────┤ │
│ │ 👁️ 🔓  🔴 セキュリティフロー  │ │
│ │        SGルール/トラフィック   │ │
│ ├─────────────────────────────┤ │
│ │ 👁️ 🔓  🟣 外部システム       │ │
│ │        オンプレ/SaaS/他Cloud  │ │
│ ├─────────────────────────────┤ │
│ │ 👁️ 🔒  🟠 コンプライアンス   │ │
│ │        Config Rules準拠状態   │ │
│ ├─────────────────────────────┤ │
│ │ 👁️ 🔓  🔵 注釈・コメント     │ │
│ │        ユーザコメント/TODO    │ │
│ └─────────────────────────────┘ │
│                                 │
│ 👁️ = 表示/非表示切替             │
│ 🔓/🔒 = ロック/アンロック         │
│                                 │
└─────────────────────────────────┘
```

---

### S09: 再インポートマージダイアログ (Phase 2)

**目的**: 新しいConfig JSONをインポートする際の変更差分確認・マージ方針選択

```
┌─── Config JSON 再インポート ────────────────────────────┐
│                                                         │
│  新しい Config JSON を検出しました                        │
│  ファイル: config-prod-20260301.json                     │
│                                                         │
│  ■ 変更サマリー                                          │
│  ┌───────────────────────────────────────────────┐      │
│  │  🟢 追加: 3 リソース                            │      │
│  │     - i-0new001 (EC2: 新規Web Server)          │      │
│  │     - rds-new01 (RDS: 新規DB)                  │      │
│  │     - sg-new01 (SecurityGroup)                 │      │
│  │                                                │      │
│  │  🔴 削除: 1 リソース                            │      │
│  │     - i-0old001 (EC2: 旧バッチサーバ)            │      │
│  │                                                │      │
│  │  🟡 変更: 5 リソース                            │      │
│  │     - i-0abc123 → タグ変更                     │      │
│  │     - vpc-0abc → CIDR追加                      │      │
│  │     - ...                                      │      │
│  │                                                │      │
│  │  ⚠️ 競合: 2 リソース（手動変更あり）              │      │
│  │     - i-0abc123: ラベル変更済み                  │      │
│  │     - subnet-123: 位置変更済み                   │      │
│  └───────────────────────────────────────────────┘      │
│                                                         │
│  マージ方針                                              │
│  ┌───────────────────────────────────────────────┐      │
│  │ ○ 手動変更を優先（AWSデータのみ更新）            │      │
│  │ ○ AWS データを優先（手動変更を上書き）            │      │
│  │ ● 競合を個別に確認して選択                       │      │
│  └───────────────────────────────────────────────┘      │
│                                                         │
│                    [キャンセル]  [インポート実行]          │
└─────────────────────────────────────────────────────────┘
```

---

### S12: Diff比較画面 (Phase 3)

**目的**: 2つのConfig JSONの差分を並べて比較

```
┌─── Diff 比較 ──────────────────────────────────────────────┐
│                                                             │
│  [ツールバー]                                                │
│  ┌───────────────────────────────────────────────────────┐  │
│  │ 📁 旧: config-202602.json  │  📁 新: config-202603.json│  │
│  │ [凡例: 🟢追加  🔴削除  🟡変更  ⬜変更なし]              │  │
│  └───────────────────────────────────────────────────────┘  │
│                                                             │
│  ┌──────────────────────┬──────────────────────┐           │
│  │  旧 (2026-02)        │  新 (2026-03)        │           │
│  │                      │                      │           │
│  │  ┌─ VPC ──────────┐  │  ┌─ VPC ──────────┐  │           │
│  │  │ ⬜[EC2-1]       │  │  │ ⬜[EC2-1]       │  │           │
│  │  │ 🔴[EC2-old]     │  │  │ 🟢[EC2-new]    │  │           │
│  │  │ 🟡[RDS]         │  │  │ 🟡[RDS]         │  │           │
│  │  │ ⬜[ALB]         │  │  │ ⬜[ALB]         │  │           │
│  │  └────────────────┘  │  └────────────────┘  │           │
│  │                      │                      │           │
│  └──────────────────────┴──────────────────────┘           │
│                                                             │
│  ■ 変更詳細                                                  │
│  ┌───────────────────────────────────────────────────────┐  │
│  │ 🟢 追加: i-0new001 (t3.medium, ap-northeast-1a)      │  │
│  │ 🔴 削除: i-0old001 (t2.micro, ap-northeast-1a)       │  │
│  │ 🟡 変更: rds-001 → Multi-AZ有効化, バックアップ7→14日 │  │
│  └───────────────────────────────────────────────────────┘  │
│                                                             │
│                              [閉じる]  [この差分をエクスポート]│
└─────────────────────────────────────────────────────────────┘
```

---

### S13: 設定ダイアログ

```
┌─── 設定 ─────────────────────────────────────┐
│                                               │
│  [Canvas] [表示] [操作]                        │
│                                               │
│  ■ Canvas 設定                                │
│  ┌───────────────────────────────────────┐    │
│  │ グリッドサイズ:  [20 ▾] px             │    │
│  │ グリッド表示:   [☑]                    │    │
│  │ スナップ:      [☑]                    │    │
│  │ 背景色:       [#FFFFFF 🎨]            │    │
│  └───────────────────────────────────────┘    │
│                                               │
│  ■ 表示設定                                    │
│  ┌───────────────────────────────────────┐    │
│  │ アイコンセット:  [AWS 2024 ▾]          │    │
│  │ ラベル表示:    [☑ リソース名]           │    │
│  │               [☐ リソースID]           │    │
│  │ ミニマップ:    [☑ 表示]                │    │
│  └───────────────────────────────────────┘    │
│                                               │
│  ■ 操作設定                                    │
│  ┌───────────────────────────────────────┐    │
│  │ ドラッグ感度:    [●────── ] 中          │    │
│  │ ダブルクリック: [詳細パネル表示 ▾]       │    │
│  └───────────────────────────────────────┘    │
│                                               │
│              [リセット]  [閉じる]               │
└───────────────────────────────────────────────┘
```

---

## 4. 画面遷移図

```
                        ┌──────────┐
                        │  S01     │
                        │ スタート  │
                        │  画面    │
                        └────┬─────┘
                             │ JSON アップロード
                             │ or サンプル選択
                             ▼
                   ┌─────────────────────┐
                   │       S02           │
                   │  メインエディタ       │◄─────────────────────┐
                   │                     │                      │
                   │  ┌──────────────┐   │                      │
                   │  │ SVG Canvas   │   │                      │
                   │  │              │   │                      │
                   │  └──────────────┘   │                      │
                   │                     │                      │
                   │  右パネル (タブ切替): │                      │
                   │  ├─ S03 詳細        │                      │
                   │  ├─ S07 コメント    │ (Phase 2)            │
                   │  ├─ S08 レイヤー    │ (Phase 2)            │
                   │  └─ S10 履歴        │ (Phase 2)            │
                   └─────────┬───────────┘
                             │
              ┌──────────────┼──────────────┬─────────────┐
              │              │              │             │
              ▼              ▼              ▼             ▼
     ┌────────────┐  ┌────────────┐  ┌──────────┐  ┌──────────┐
     │    S04     │  │    S05     │  │   S09    │  │   S13    │
     │ エクスポート│  │外部システム │  │再インポート│  │  設定    │
     │ ダイアログ  │  │追加(Ph.2)  │  │マージ(Ph2)│  │ダイアログ │
     └────────────┘  └────────────┘  └──────────┘  └──────────┘
              │              │              │             │
              └──────────────┴──────────────┴─────────────┘
                             │ モーダル閉じる → S02 に戻る
                             ▼
                   ┌─────────────────────┐
                   │       S12           │
                   │  Diff 比較画面       │ (Phase 3)
                   │                     │
                   │  [閉じる] → S02     │
                   └─────────────────────┘
```

### 主要な遷移フロー

| # | フロー名 | 遷移 | トリガー |
|---|---------|------|---------|
| T01 | 初回アップロード | S01 → S02 | JSONファイルドロップ/選択 |
| T02 | リソース選択 | S02 Canvas → S03 パネル | Canvas上のリソースをクリック |
| T03 | エクスポート | S02 → S04 → (ダウンロード) → S02 | ツールバーの Export ボタン |
| T04 | 外部システム追加 | S02 → S05 → S02 (ノード追加) | ツールバーの AddNode ボタン |
| T05 | 接続線追加 | S02 → S06 (オーバーレイ) → S02 | ツールバーの Edge ボタン |
| T06 | コメント追加 | S02 Canvas右クリック → S07 パネル | 右クリックメニュー or Cキー |
| T07 | レイヤー切替 | S02 → S08 パネル | 右パネルのレイヤータブ |
| T08 | 再インポート | S02 → S09 → S02 (マージ完了) | File ▾ > インポート |
| T09 | Diff比較 | S02 → S12 → S02 | File ▾ > 差分比較 |
| T10 | 設定 | S02 → S13 → S02 | ⚙️ ボタン |
| T11 | 新規ファイル | S02 → S01 | File ▾ > 新規 |
| T12 | バージョン復元 | S02 → S10 パネル → S02 (復元) | 右パネルの履歴タブ |

---

## 5. 操作モード一覧

Canvas 上の操作モードは排他的（1つだけアクティブ）:

| モード | ショートカット | マウス左クリック | マウスドラッグ | 対象フェーズ |
|--------|-------------|---------------|-------------|------------|
| Select (デフォルト) | V | リソース選択 | リソース移動 | MVP |
| Pan | H (or Space押下中) | - | Canvas 移動 | MVP |
| Edge | E | 始点選択 | 接続線プレビュー | Phase 2 |
| Comment | C | コメント配置 | - | Phase 2 |

**共通操作**（全モードで有効）:
- マウスホイール: ズーム
- Ctrl+Z / Ctrl+Shift+Z: Undo/Redo
- Delete / Backspace: 選択要素の削除（user-manual のみ）
- Ctrl+A: 全選択
- Escape: 選択解除 / モード切替をSelectに戻す

---

## 6. ChatGPT 画面イメージ生成用プロンプト一覧

以下のプロンプトをChatGPTに渡して、各画面のUIモックアップ画像を生成する。

### プロンプト共通条件

```
共通条件:
- ツールのカラーテーマ: ダークブルー系のプロフェッショナルなUI
- フォント: システムフォント（San Francisco / Segoe UI 系）
- 配色: 背景 #1a1a2e, サイドバー #16213e, アクセント #0f3460, ハイライト #e94560
- AWS公式アイコンスタイルを使用
- 言語: 日本語 UI
- 解像度: 1920x1080 (デスクトップ)
- モダンでクリーンなデザイン（Figma / Linear / Notion 風）
```

### 各画面のプロンプト

| # | 画面 | ChatGPT プロンプト要約 |
|---|------|---------------------|
| P01 | S01 スタート画面 | ダークテーマのファイルアップロード画面。中央にドラッグ&ドロップエリア。AWSロゴ風のブランディング |
| P02 | S02 メインエディタ (全体) | AWS構成図エディタのメイン画面。上部ツールバー、中央にSVG Canvas（VPC/Subnet/EC2等の構成図）、右にリソース詳細パネル、下部ステータスバー |
| P03 | S02 Canvas拡大 | SVG Canvas上のAWS構成図。VPC枠内にAZ、Subnet、EC2/RDS/ALBがネストされた4階層表示。AWS公式アイコン使用 |
| P04 | S03 リソース詳細パネル | EC2インスタンスの詳細パネル。基本情報、ネットワーク、SG、タグのセクション。ロック/表示トグル |
| P05 | S04 エクスポートダイアログ | Excel/PPTX選択のエクスポートモーダル。フォーマットカード、オプションチェックボックス |
| P06 | S05 外部システム追加 | テンプレート選択（オンプレ/SaaS/他Cloud）+ フォーム入力のモーダル |
| P07 | S07 コメントパネル | コメントスレッド表示。アンカー付きコメント、返信チェーン、解決済みバッジ |
| P08 | S08 レイヤーパネル | 5レイヤーのリスト。表示/非表示アイコン、ロック/アンロックアイコン、色バッジ |
| P09 | S09 再インポートマージ | 変更サマリー（追加/削除/変更/競合の件数）+ マージ方針ラジオボタン |
| P10 | S12 Diff比較画面 | 2カラムの構成図比較。追加(緑)/削除(赤)/変更(黄)の色分けハイライト |
| P11 | S13 設定ダイアログ | タブ形式の設定画面。Canvas/表示/操作の3タブ |

---

## 7. レスポンシブ対応（参考）

MVP ではデスクトップ (1280px+) のみ対応。将来的にタブレット対応を検討。

| ブレークポイント | レイアウト変更 |
|---------------|-------------|
| 1280px+ | フル表示（Canvas + 右パネル並列） |
| 1024-1279px | 右パネルをオーバーレイ表示 |
| 768-1023px | ツールバー簡略化、右パネルはドロワー |
| < 768px | 非対応（デスクトップ推奨メッセージ） |
